rules:
  - rule_id: 'prevent_allow_all'
    description: Prevent allow all policies
    type: blacklist
    match_policies:
      - direction: ingress
        allowed: ['*']
    verify_policies:
      - allowed:
        - IPProtocol: 'all'

  - rule_id: 'disallow_any_port'
    description: Don't allow policies that expose every port
    type: blacklist
    match_policies:
      - direction: ingress
        allowed: ['*']
    verify_policies:
      - allowed:
        - IPProtocol: 'tcp'
          ports:
            - 'all'
      - allowed:
        - IPProtocol: 'udp'
          ports:
            - 'all'

rule_groups:
  - group_id: 'default_rules'
    rule_ids:
      - 'prevent_allow_all'
        'disallow_any_port'

org_policy:
  resources:
    - type: organization
      resource_ids:
      rules:
        group_ids:
          - 'default_rules'
