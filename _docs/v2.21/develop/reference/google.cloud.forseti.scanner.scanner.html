---
layout: docs

title: "google.cloud.forseti.scanner.scanner module"



hide:
  right_sidebar: true
---
<div class="section" id="module-google.cloud.forseti.scanner.scanner">
<span id="google-cloud-forseti-scanner-scanner-module"></span><h1>google.cloud.forseti.scanner.scanner module<a class="headerlink" href="#module-google.cloud.forseti.scanner.scanner" title="Permalink to this headline">¶</a></h1>
<p>GCP Resource scanner.</p>
<dl class="function">
<dt id="google.cloud.forseti.scanner.scanner._error_message">
<code class="descname">_error_message</code><span class="sig-paren">(</span><em>failed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/google/cloud/forseti/scanner/scanner.html#_error_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.forseti.scanner.scanner._error_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct error message for failed scanners.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>failed</strong> (<em>list</em>) – names of scanners that failed</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">error message detailing the scanners that failed</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="google.cloud.forseti.scanner.scanner.init_scanner_index">
<code class="descname">init_scanner_index</code><span class="sig-paren">(</span><em>session</em>, <em>inventory_index_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/google/cloud/forseti/scanner/scanner.html#init_scanner_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.forseti.scanner.scanner.init_scanner_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the ‘scanner_index’ table.</p>
<p>Make sure we have a ‘scanner_index’ row for the current scanner run.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>session</strong> (<em>Session</em>) – SQLAlchemy session object.</li>
<li><strong>inventory_index_id</strong> (<em>str</em>) – Id of the inventory index.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the id of the ‘scanner_index’ db row</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="google.cloud.forseti.scanner.scanner.mark_scanner_index_complete">
<code class="descname">mark_scanner_index_complete</code><span class="sig-paren">(</span><em>session</em>, <em>scanner_index_id</em>, <em>succeeded</em>, <em>failed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/google/cloud/forseti/scanner/scanner.html#mark_scanner_index_complete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.forseti.scanner.scanner.mark_scanner_index_complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark the current ‘scanner_index’ row as complete.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>session</strong> (<em>Session</em>) – SQLAlchemy session object.</li>
<li><strong>scanner_index_id</strong> (<em>str</em>) – id of the <cite>ScannerIndex</cite> row to mark</li>
<li><strong>succeeded</strong> (<em>list</em>) – names of scanners that ran successfully</li>
<li><strong>failed</strong> (<em>list</em>) – names of scanners that failed</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="google.cloud.forseti.scanner.scanner.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>model_name=None</em>, <em>progress_queue=None</em>, <em>service_config=None</em>, <em>scanner_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/google/cloud/forseti/scanner/scanner.html#run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.forseti.scanner.scanner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the scanners.</p>
<p>Entry point when the scanner is run as a library.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model_name</strong> (<em>str</em>) – The name of the data model.</li>
<li><strong>progress_queue</strong> (<em>Queue</em>) – The progress queue.</li>
<li><strong>service_config</strong> (<a class="reference internal" href="google.cloud.forseti.services.base.config.html#google.cloud.forseti.services.base.config.ServiceConfig" title="google.cloud.forseti.services.base.config.ServiceConfig"><em>ServiceConfig</em></a>) – Forseti 2.0 service configs.</li>
<li><strong>scanner_name</strong> (<em>str</em>) – Name of the scanner that runs separately.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Status code.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>

