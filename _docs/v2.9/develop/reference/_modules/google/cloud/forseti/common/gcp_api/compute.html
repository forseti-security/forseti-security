---
layout: docs

title: "google.cloud.forseti.common.gcp_api.compute"



hide:
  right_sidebar: true
---
<h1>Source code for google.cloud.forseti.common.gcp_api.compute</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2017 The Forseti Security Authors. All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#      http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="sd">&quot;&quot;&quot;Wrapper for Compute API client.&quot;&quot;&quot;</span>
<span class="c1"># pylint: disable=too-many-lines</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="k">import</span> <span class="n">uuid4</span>
<span class="kn">from</span> <span class="nn">googleapiclient</span> <span class="k">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">httplib2</span> <span class="k">import</span> <span class="n">HttpLib2Error</span>

<span class="kn">from</span> <span class="nn">google.cloud.forseti.common.gcp_api</span> <span class="k">import</span> <span class="n">_base_repository</span>
<span class="kn">from</span> <span class="nn">google.cloud.forseti.common.gcp_api</span> <span class="k">import</span> <span class="n">api_helpers</span>
<span class="kn">from</span> <span class="nn">google.cloud.forseti.common.gcp_api</span> <span class="k">import</span> <span class="n">errors</span> <span class="k">as</span> <span class="n">api_errors</span>
<span class="kn">from</span> <span class="nn">google.cloud.forseti.common.gcp_api</span> <span class="k">import</span> <span class="n">repository_mixins</span>
<span class="kn">from</span> <span class="nn">google.cloud.forseti.common.util</span> <span class="k">import</span> <span class="n">date_time</span>
<span class="kn">from</span> <span class="nn">google.cloud.forseti.common.util</span> <span class="k">import</span> <span class="n">logger</span>

<span class="n">LOGGER</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">API_NAME</span> <span class="o">=</span> <span class="s1">&#39;compute&#39;</span>


<div class="viewcode-block" id="_api_not_enabled"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._api_not_enabled">[docs]</a><span class="k">def</span> <span class="nf">_api_not_enabled</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks if the error is due to the API not being enabled for project.</span>

<span class="sd">    Args:</span>
<span class="sd">        error (Exception): The error to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (bool, str) True, API not enabled reason if API is not enabled</span>
<span class="sd">            or False, &#39;&#39; if there is a different exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">403</span> <span class="ow">and</span>
                <span class="n">error</span><span class="o">.</span><span class="n">resp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;application/json&#39;</span><span class="p">)):</span>

            <span class="c1"># If a project doesn&#39;t have the necessary API enabled, Google</span>
            <span class="c1"># will return an error domain=usageLimits and</span>
            <span class="c1"># reason=accessNotConfigured. Clients may wish to handle this</span>
            <span class="c1"># error in some particular way. For instance, when listing</span>
            <span class="c1"># resources, it might be treated as &quot;no resources of that type</span>
            <span class="c1"># are present&quot;, if the API would need to be enabled in order</span>
            <span class="c1"># to create the resources in question!</span>
            <span class="c1">#</span>
            <span class="c1"># So, if we find that specific error, raise a different</span>
            <span class="c1"># exception to indicate it to callers. Otherwise, propagate</span>
            <span class="c1"># the initial exception.</span>
            <span class="n">error_details</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
            <span class="n">all_errors</span> <span class="o">=</span> <span class="n">error_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;errors&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">api_disabled_errors</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">err</span> <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">all_errors</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domain&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;usageLimits&#39;</span> <span class="ow">and</span>
                    <span class="n">err</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reason&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;accessNotConfigured&#39;</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">api_disabled_errors</span> <span class="ow">and</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">api_disabled_errors</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_errors</span><span class="p">)):</span>
                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">api_disabled_errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;extendedHelp&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;&#39;</span></div>


<span class="c1"># pylint: disable=invalid-name</span>
<div class="viewcode-block" id="_flatten_aggregated_list_results"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._flatten_aggregated_list_results">[docs]</a><span class="k">def</span> <span class="nf">_flatten_aggregated_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">paged_results</span><span class="p">,</span> <span class="n">item_key</span><span class="p">,</span>
                                     <span class="n">sort_key</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Flatten results and handle exceptions.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_id (str): The project id the results are for.</span>
<span class="sd">        paged_results (list): A list of paged API response objects.</span>
<span class="sd">            [{page 1 results}, {page 2 results}, {page 3 results}, ...]</span>
<span class="sd">        item_key (str): The name of the key within the inner &quot;items&quot; lists</span>
<span class="sd">            containing the objects of interest.</span>
<span class="sd">        sort_key (str): The name of the key to sort the results by before</span>
<span class="sd">            returning.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A sorted list of items.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ApiNotEnabledError: Raised if the API is not enabled for the project.</span>
<span class="sd">        ApiExecutionError: Raised if there is another error while calling the</span>
<span class="sd">            API method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="n">api_helpers</span><span class="o">.</span><span class="n">flatten_aggregated_list_results</span><span class="p">(</span><span class="n">paged_results</span><span class="p">,</span>
                                                        <span class="n">item_key</span><span class="p">),</span>
            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sort_key</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiNotEnabledError</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>
<span class="c1"># pylint: enable=invalid-name</span>


<div class="viewcode-block" id="_flatten_list_results"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._flatten_list_results">[docs]</a><span class="k">def</span> <span class="nf">_flatten_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">paged_results</span><span class="p">,</span> <span class="n">item_key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Flatten results and handle exceptions.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_id (str): The project id the results are for.</span>
<span class="sd">        paged_results (list): A list of paged API response objects.</span>
<span class="sd">            [{page 1 results}, {page 2 results}, {page 3 results}, ...]</span>
<span class="sd">        item_key (str): The name of the key within the inner &quot;items&quot; lists</span>
<span class="sd">            containing the objects of interest.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of items.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ApiNotEnabledError: Raised if the API is not enabled for the project.</span>
<span class="sd">        ApiExecutionError: Raised if there is another error while calling the</span>
<span class="sd">            API method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">api_helpers</span><span class="o">.</span><span class="n">flatten_list_results</span><span class="p">(</span><span class="n">paged_results</span><span class="p">,</span> <span class="n">item_key</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiNotEnabledError</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="_debug_operation_response_time"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._debug_operation_response_time">[docs]</a><span class="k">def</span> <span class="nf">_debug_operation_response_time</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">operation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Log timing details for a running operation if debug logs enabled.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_id (str): The project id the operation was for.</span>
<span class="sd">        operation (dict): The last Operation resource returned from the</span>
<span class="sd">            API server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">LOGGER</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
        <span class="c1"># Don&#39;t compute times if DEBUG logging is not enabled.</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">op_insert_timestamp</span> <span class="o">=</span> <span class="n">date_time</span><span class="o">.</span><span class="n">get_unix_timestamp_from_string</span><span class="p">(</span>
            <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;insertTime&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="n">op_start_timestamp</span> <span class="o">=</span> <span class="n">date_time</span><span class="o">.</span><span class="n">get_unix_timestamp_from_string</span><span class="p">(</span>
            <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;startTime&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="n">op_end_timestamp</span> <span class="o">=</span> <span class="n">date_time</span><span class="o">.</span><span class="n">get_unix_timestamp_from_string</span><span class="p">(</span>
            <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;endTime&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">op_insert_timestamp</span> <span class="o">=</span> <span class="n">op_start_timestamp</span> <span class="o">=</span> <span class="n">op_end_timestamp</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">op_wait_time</span> <span class="o">=</span> <span class="n">op_end_timestamp</span> <span class="o">-</span> <span class="n">op_insert_timestamp</span>
    <span class="n">op_exec_time</span> <span class="o">=</span> <span class="n">op_end_timestamp</span> <span class="o">-</span> <span class="n">op_start_timestamp</span>
    <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Operation </span><span class="si">%s</span><span class="s1"> completed for project </span><span class="si">%s</span><span class="s1">. Operation type: </span><span class="si">%s</span><span class="s1">, &#39;</span>
                 <span class="s1">&#39;request time: </span><span class="si">%s</span><span class="s1">, start time: </span><span class="si">%s</span><span class="s1">, finished time: </span><span class="si">%s</span><span class="s1">, &#39;</span>
                 <span class="s1">&#39;req-&gt;end seconds: </span><span class="si">%i</span><span class="s1">, start-&gt;end seconds: </span><span class="si">%i</span><span class="s1">.&#39;</span><span class="p">,</span>
                 <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                 <span class="n">project_id</span><span class="p">,</span>
                 <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;operationType&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                 <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;insertTime&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                 <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;startTime&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                 <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;endTime&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">op_wait_time</span><span class="p">,</span> <span class="n">op_exec_time</span><span class="p">)</span></div>


<span class="c1"># pylint: disable=too-many-instance-attributes</span>
<div class="viewcode-block" id="ComputeRepositoryClient"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeRepositoryClient">[docs]</a><span class="k">class</span> <span class="nc">ComputeRepositoryClient</span><span class="p">(</span><span class="n">_base_repository</span><span class="o">.</span><span class="n">BaseRepositoryClient</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute API Respository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">quota_max_calls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">quota_period</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
                 <span class="n">use_rate_limiter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            quota_max_calls (int): Allowed requests per &lt;quota_period&gt; for the</span>
<span class="sd">                API.</span>
<span class="sd">            quota_period (float): The time period to track requests over.</span>
<span class="sd">            use_rate_limiter (bool): Set to false to disable the use of a rate</span>
<span class="sd">                limiter for this service.</span>
<span class="sd">            read_only (bool): When set to true, disables any API calls that</span>
<span class="sd">                would modify a resource within the repository.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">quota_max_calls</span><span class="p">:</span>
            <span class="n">use_rate_limiter</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_backend_services</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disks</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_firewalls</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_forwarding_rules</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_operations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_images</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_instance_group_managers</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_instance_groups</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_instance_templates</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_instances</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_networks</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_projects</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_region_instance_groups</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_snapshots</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subnetworks</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ComputeRepositoryClient</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">API_NAME</span><span class="p">,</span> <span class="n">versions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;v1&#39;</span><span class="p">],</span>
            <span class="n">quota_max_calls</span><span class="o">=</span><span class="n">quota_max_calls</span><span class="p">,</span>
            <span class="n">quota_period</span><span class="o">=</span><span class="n">quota_period</span><span class="p">,</span>
            <span class="n">use_rate_limiter</span><span class="o">=</span><span class="n">use_rate_limiter</span><span class="p">,</span>
            <span class="n">read_only</span><span class="o">=</span><span class="n">read_only</span><span class="p">)</span>

    <span class="c1"># Turn off docstrings for properties.</span>
    <span class="c1"># pylint: disable=missing-return-doc, missing-return-type-doc</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">backend_services</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeBackendServicesRepository instance.&quot;&quot;&quot;</span>
        <span class="c1"># The beta api provides IAP data.</span>
        <span class="c1"># TODO: Remove beta when it becomes GA.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend_services</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_backend_services</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeBackendServicesRepository</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend_services</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">disks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeDisksRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_disks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeDisksRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">firewalls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeFirewallsRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_firewalls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_firewalls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeFirewallsRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_firewalls</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">forwarding_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeForwardingRulesRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forwarding_rules</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_forwarding_rules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeForwardingRulesRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forwarding_rules</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">global_operations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeGlobalOperationsRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_operations</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_global_operations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeGlobalOperationsRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_operations</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeImagesRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_images</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeImagesRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instance_group_managers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeInstanceGroupManagersRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_group_managers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_instance_group_managers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeInstanceGroupManagersRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_group_managers</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instance_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeInstanceGroupsRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_groups</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_instance_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeInstanceGroupsRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_groups</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instance_templates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeInstanceTemplatesRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_templates</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_instance_templates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeInstanceTemplatesRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_templates</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeInstancesRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instances</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeInstancesRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instances</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">networks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeNetworksRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_networks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_networks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeNetworksRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_networks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">projects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeProjectsRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_projects</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_projects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeProjectsRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_projects</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">region_instance_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeRegionInstanceGroupsRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_region_instance_groups</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_region_instance_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeRegionInstanceGroupsRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_region_instance_groups</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">snapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeSnapshotsRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_snapshots</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_snapshots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeSnapshotsRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_snapshots</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">subnetworks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a _ComputeSubnetworksRepository instance.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subnetworks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subnetworks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_repository</span><span class="p">(</span>
                <span class="n">_ComputeSubnetworksRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subnetworks</span></div>
    <span class="c1"># pylint: enable=missing-return-doc, missing-return-type-doc</span>


<span class="c1"># pylint: enable=too-many-instance-attributes</span>


<div class="viewcode-block" id="_ComputeBackendServicesRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeBackendServicesRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeBackendServicesRepository</span><span class="p">(</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">AggregatedListQueryMixin</span><span class="p">,</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
        <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Backend Services repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeBackendServicesRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;backendServices&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="_ComputeDisksRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeDisksRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeDisksRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">AggregatedListQueryMixin</span><span class="p">,</span>
                              <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
                              <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Disks repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeDisksRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;disks&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Extend the base list implementation to support the required zone field.</span>
    <span class="c1"># pylint: disable=arguments-differ</span>
<div class="viewcode-block" id="_ComputeDisksRepository.list"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeDisksRepository.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List disks by zone.</span>

<span class="sd">        Args:</span>
<span class="sd">            resource (str): The project to query resources for.</span>
<span class="sd">            zone (str): The zone of the instance group to query.</span>
<span class="sd">            **kwargs (dict): Additional args to pass through to the base method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            iterator: An iterator over each page of results from the API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zone</span>
        <span class="k">return</span> <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
    <span class="c1"># pylint: enable=arguments-differ</span>


<div class="viewcode-block" id="_ComputeFirewallsRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeFirewallsRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeFirewallsRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
                                  <span class="n">repository_mixins</span><span class="o">.</span><span class="n">InsertResourceMixin</span><span class="p">,</span>
                                  <span class="n">repository_mixins</span><span class="o">.</span><span class="n">UpdateResourceMixin</span><span class="p">,</span>
                                  <span class="n">repository_mixins</span><span class="o">.</span><span class="n">DeleteResourceMixin</span><span class="p">,</span>
                                  <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Firewall Rules repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeFirewallsRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;firewalls&#39;</span><span class="p">,</span> <span class="n">entity_field</span><span class="o">=</span><span class="s1">&#39;firewall&#39;</span><span class="p">,</span>
            <span class="n">resource_path_template</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{project}</span><span class="s1">/global/firewalls/</span><span class="si">{firewall}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="_ComputeForwardingRulesRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeForwardingRulesRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeForwardingRulesRepository</span><span class="p">(</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">AggregatedListQueryMixin</span><span class="p">,</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
        <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Forwarding Rules repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeForwardingRulesRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;forwardingRules&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Extend the base list implementation to support the required region field.</span>
    <span class="c1"># pylint: disable=arguments-differ</span>
<div class="viewcode-block" id="_ComputeForwardingRulesRepository.list"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeForwardingRulesRepository.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List instances by zone.</span>

<span class="sd">        Args:</span>
<span class="sd">            resource (str): The project to query resources for.</span>
<span class="sd">            region (str): The region of the forwarding rules to query.</span>
<span class="sd">            **kwargs (dict): Additional args to pass through to the base method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            iterator: An iterator over each page of results from the API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">region</span>
        <span class="k">return</span> <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
    <span class="c1"># pylint: enable=arguments-differ</span>


<div class="viewcode-block" id="_ComputeGlobalOperationsRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeGlobalOperationsRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeGlobalOperationsRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">GetQueryMixin</span><span class="p">,</span>
                                         <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Global Operations repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeGlobalOperationsRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;globalOperations&#39;</span><span class="p">,</span> <span class="n">entity_field</span><span class="o">=</span><span class="s1">&#39;operation&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="_ComputeImagesRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeImagesRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeImagesRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">GetQueryMixin</span><span class="p">,</span>
                               <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
                               <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Images repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeImagesRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="n">entity_field</span><span class="o">=</span><span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="_ComputeInstanceGroupManagersRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeInstanceGroupManagersRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeInstanceGroupManagersRepository</span><span class="p">(</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">AggregatedListQueryMixin</span><span class="p">,</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
        <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Instance Group Managers repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeInstanceGroupManagersRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;instanceGroupManagers&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="_ComputeInstanceGroupsRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeInstanceGroupsRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeInstanceGroupsRepository</span><span class="p">(</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">AggregatedListQueryMixin</span><span class="p">,</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
        <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Instance Groups repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">           **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeInstanceGroupsRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;instanceGroups&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="_ComputeInstanceGroupsRepository.list_instances"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeInstanceGroupsRepository.list_instances">[docs]</a>    <span class="k">def</span> <span class="nf">list_instances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">instance_group</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List instances for instance group.</span>

<span class="sd">        Args:</span>
<span class="sd">            resource (str): The project to query resources for.</span>
<span class="sd">            instance_group (str): The name of the instance group to query.</span>
<span class="sd">            zone (str): The zone of the instance group to query.</span>
<span class="sd">            **kwargs (dict): Additional args to pass through to the base method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            iterator: An iterator over each page of results from the API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;instanceGroup&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance_group</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zone</span>
        <span class="k">return</span> <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s1">&#39;listInstances&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="_ComputeInstanceTemplatesRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeInstanceTemplatesRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeInstanceTemplatesRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
                                          <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Instance Templates repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeInstanceTemplatesRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;instanceTemplates&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="_ComputeInstancesRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeInstancesRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeInstancesRepository</span><span class="p">(</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">AggregatedListQueryMixin</span><span class="p">,</span>
        <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
        <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Instances repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeInstancesRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;instances&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Extend the base list implementation to support the required zone field.</span>
    <span class="c1"># pylint: disable=arguments-differ</span>
<div class="viewcode-block" id="_ComputeInstancesRepository.list"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeInstancesRepository.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List instances by zone.</span>

<span class="sd">        Args:</span>
<span class="sd">            resource (str): The project to query resources for.</span>
<span class="sd">            zone (str): The zone of the instance group to query.</span>
<span class="sd">            **kwargs (dict): Additional args to pass through to the base method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            iterator: An iterator over each page of results from the API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zone</span>
        <span class="k">return</span> <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
    <span class="c1"># pylint: enable=arguments-differ</span>


<div class="viewcode-block" id="_ComputeNetworksRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeNetworksRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeNetworksRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
                                 <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Networks repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeNetworksRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;networks&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="_ComputeProjectsRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeProjectsRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeProjectsRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">GetQueryMixin</span><span class="p">,</span>
                                 <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Projects repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeProjectsRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;projects&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="_ComputeRegionInstanceGroupsRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeRegionInstanceGroupsRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeRegionInstanceGroupsRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
                                             <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Region Instance Groups repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeRegionInstanceGroupsRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;regionInstanceGroups&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="_ComputeRegionInstanceGroupsRepository.list_instances"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeRegionInstanceGroupsRepository.list_instances">[docs]</a>    <span class="k">def</span> <span class="nf">list_instances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">instance_group</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List instances for instance group.</span>

<span class="sd">        Args:</span>
<span class="sd">            resource (str): The project to query resources for.</span>
<span class="sd">            instance_group (str): The name of the instance group to query.</span>
<span class="sd">            region (str): The region of the instance group to query.</span>
<span class="sd">            **kwargs (dict): Additional args to pass through to the base method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            iterator: An iterator over each page of results from the API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;instanceGroup&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance_group</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">region</span>
        <span class="k">return</span> <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s1">&#39;listInstances&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="_ComputeSnapshotsRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeSnapshotsRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeSnapshotsRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
                                  <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Snapshots repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeSnapshotsRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;snapshots&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="_ComputeSubnetworksRepository"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeSubnetworksRepository">[docs]</a><span class="k">class</span> <span class="nc">_ComputeSubnetworksRepository</span><span class="p">(</span><span class="n">repository_mixins</span><span class="o">.</span><span class="n">AggregatedListQueryMixin</span><span class="p">,</span>
                                    <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="p">,</span>
                                    <span class="n">_base_repository</span><span class="o">.</span><span class="n">GCPRepository</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of Compute Subnetworks repository.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs (dict): The args to pass into GCPRepository.__init__()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_ComputeSubnetworksRepository</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">component</span><span class="o">=</span><span class="s1">&#39;subnetworks&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Extend the base list implementation to support the required region field.</span>
    <span class="c1"># pylint: disable=arguments-differ</span>
<div class="viewcode-block" id="_ComputeSubnetworksRepository.list"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute._ComputeSubnetworksRepository.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List subnetworks by region.</span>

<span class="sd">        Args:</span>
<span class="sd">            resource (str): The project to query resources for.</span>
<span class="sd">            region (str): The region of the forwarding rules to query.</span>
<span class="sd">            **kwargs (dict): Additional args to pass through to the base method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            iterator: An iterator over each page of results from the API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">region</span>
        <span class="k">return</span> <span class="n">repository_mixins</span><span class="o">.</span><span class="n">ListQueryMixin</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
    <span class="c1"># pylint: enable=arguments-differ</span>


<span class="c1"># pylint: disable=too-many-public-methods</span>
<div class="viewcode-block" id="ComputeClient"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient">[docs]</a><span class="k">class</span> <span class="nc">ComputeClient</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute Client.&quot;&quot;&quot;</span>

    <span class="c1"># Estimation of how long to initially wait for an async API to complete.</span>
    <span class="n">ESTIMATED_API_COMPLETION_IN_SEC</span> <span class="o">=</span> <span class="mi">7</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">global_configs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize.</span>

<span class="sd">        Args:</span>
<span class="sd">            global_configs (dict): Forseti config.</span>
<span class="sd">            **kwargs (dict): The kwargs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_calls</span><span class="p">,</span> <span class="n">quota_period</span> <span class="o">=</span> <span class="n">api_helpers</span><span class="o">.</span><span class="n">get_ratelimiter_config</span><span class="p">(</span>
            <span class="n">global_configs</span><span class="p">,</span> <span class="n">API_NAME</span><span class="p">)</span>

        <span class="c1"># TODO: Also allow read only to be set from the global_configs.</span>
        <span class="c1"># Read only if either read_only or dry_run argument is True.</span>
        <span class="n">read_only</span> <span class="o">=</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;read_only&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span>
                     <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dry_run&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span> <span class="o">=</span> <span class="n">ComputeRepositoryClient</span><span class="p">(</span>
            <span class="n">quota_max_calls</span><span class="o">=</span><span class="n">max_calls</span><span class="p">,</span>
            <span class="n">quota_period</span><span class="o">=</span><span class="n">quota_period</span><span class="p">,</span>
            <span class="n">read_only</span><span class="o">=</span><span class="n">read_only</span><span class="p">,</span>
            <span class="n">use_rate_limiter</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_rate_limiter&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

<div class="viewcode-block" id="ComputeClient.get_backend_services"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_backend_services">[docs]</a>    <span class="k">def</span> <span class="nf">get_backend_services</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the backend services for a project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of backend services for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paged_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">backend_services</span><span class="o">.</span><span class="n">aggregated_list</span><span class="p">(</span>
            <span class="n">project_id</span><span class="p">)</span>
        <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_aggregated_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                             <span class="n">paged_results</span><span class="p">,</span>
                                                             <span class="s1">&#39;backendServices&#39;</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the backend services of a project, &#39;</span>
                     <span class="s1">&#39;project_id = </span><span class="si">%s</span><span class="s1">, flattened_results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">flattened_results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flattened_results</span></div>

<div class="viewcode-block" id="ComputeClient.get_disks"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_disks">[docs]</a>    <span class="k">def</span> <span class="nf">get_disks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of all disks in the project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            zone (str): An optional zone to query, if not provided then all</span>
<span class="sd">                disks in all zones are returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of disk resources for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">disks</span>
        <span class="k">if</span> <span class="n">zone</span><span class="p">:</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">_flatten_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">paged_results</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">aggregated_list</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">_flatten_aggregated_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                       <span class="n">paged_results</span><span class="p">,</span>
                                                       <span class="s1">&#39;disks&#39;</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the list of all disks in the project,&#39;</span>
                     <span class="s1">&#39; project_id = </span><span class="si">%s</span><span class="s1">, zone = </span><span class="si">%s</span><span class="s1">, results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="ComputeClient.get_snapshots"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_snapshots">[docs]</a>    <span class="k">def</span> <span class="nf">get_snapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of all snapshots in the project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of snapshot resources for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the list of all snapshots in project: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                         <span class="n">project_id</span><span class="p">)</span>
            <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">snapshots</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">api_helpers</span><span class="o">.</span><span class="n">flatten_list_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiNotEnabledError</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">err</span></div>

<div class="viewcode-block" id="ComputeClient.get_firewall_rules"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_firewall_rules">[docs]</a>    <span class="k">def</span> <span class="nf">get_firewall_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the firewall rules for a given project id.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of firewall rules for this project id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paged_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">firewalls</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
        <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                  <span class="n">paged_results</span><span class="p">,</span>
                                                  <span class="s1">&#39;items&#39;</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the firewall rules of a given project, &#39;</span>
                     <span class="s1">&#39;project_id = </span><span class="si">%s</span><span class="s1">, flattened_results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">flattened_results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flattened_results</span></div>

<div class="viewcode-block" id="ComputeClient.delete_firewall_rule"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.delete_firewall_rule">[docs]</a>    <span class="k">def</span> <span class="nf">delete_firewall_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">retry_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a firewall rule.</span>

<span class="sd">        Args:</span>
<span class="sd">          project_id (str): The project id.</span>
<span class="sd">          rule (dict): The firewall rule dict to delete.</span>
<span class="sd">          uuid (str): An optional UUID to identify this request. If the same</span>
<span class="sd">              request is resent to the API, it will ignore the additional</span>
<span class="sd">              requests. If uuid is not set, one will be generated for the</span>
<span class="sd">              request.</span>
<span class="sd">          blocking (bool): If true, don&#39;t return until the async operation</span>
<span class="sd">              completes on the backend or timeout seconds pass.</span>
<span class="sd">          retry_count (int): If greater than 0, retry on operation timeout.</span>
<span class="sd">          timeout (float): If greater than 0 and blocking is True, then raise an</span>
<span class="sd">              exception if timeout seconds pass before the operation completes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Global Operation status and info.</span>
<span class="sd">            https://cloud.google.com/compute/docs/reference/latest/globalOperations/get</span>

<span class="sd">        Raises:</span>
<span class="sd">            OperationTimeoutError: Raised if the operation times out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">firewalls</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">uuid</span><span class="p">:</span>
            <span class="n">uuid</span> <span class="o">=</span> <span class="n">uuid4</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                        <span class="n">requestId</span><span class="o">=</span><span class="n">uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">blocking</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Error deleting firewall rule </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiNotEnabledError</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">OperationTimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s1">&#39;Timeout deleting firewall rule </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">retry_count</span><span class="p">:</span>
                <span class="n">retry_count</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_firewall_rule</span><span class="p">(</span>
                    <span class="n">project_id</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">blocking</span><span class="p">,</span> <span class="n">retry_count</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s1">&#39;Deleting firewall rule </span><span class="si">%s</span><span class="s1"> on project </span><span class="si">%s</span><span class="s1">. Rule: </span><span class="si">%s</span><span class="s1">, &#39;</span>
            <span class="s1">&#39;Result: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">rule</span><span class="p">),</span> <span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="ComputeClient.insert_firewall_rule"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.insert_firewall_rule">[docs]</a>    <span class="k">def</span> <span class="nf">insert_firewall_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">retry_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert a firewall rule.</span>

<span class="sd">        Args:</span>
<span class="sd">          project_id (str): The project id.</span>
<span class="sd">          rule (dict): The firewall rule dict to insert.</span>
<span class="sd">          uuid (str): An optional UUID to identify this request. If the same</span>
<span class="sd">              request is resent to the API, it will ignore the additional</span>
<span class="sd">              requests. If uuid is not set, one will be generated for the</span>
<span class="sd">              request.</span>
<span class="sd">          blocking (bool): If true, don&#39;t return until the async operation</span>
<span class="sd">              completes on the backend or timeout seconds pass.</span>
<span class="sd">          retry_count (int): If greater than 0, retry on operation timeout.</span>
<span class="sd">          timeout (float): If greater than 0 and blocking is True, then raise an</span>
<span class="sd">              exception if timeout seconds pass before the operation completes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Global Operation status and info.</span>
<span class="sd">            https://cloud.google.com/compute/docs/reference/latest/globalOperations/get</span>

<span class="sd">        Raises:</span>
<span class="sd">            OperationTimeoutError: Raised if the operation times out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">firewalls</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">uuid</span><span class="p">:</span>
            <span class="n">uuid</span> <span class="o">=</span> <span class="n">uuid4</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">rule</span><span class="p">,</span> <span class="n">requestId</span><span class="o">=</span><span class="n">uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">blocking</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s1">&#39;Error inserting firewall rule </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiNotEnabledError</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">OperationTimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s1">&#39;Timeout inserting firewall rule </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">retry_count</span><span class="p">:</span>
                <span class="n">retry_count</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_firewall_rule</span><span class="p">(</span>
                    <span class="n">project_id</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">blocking</span><span class="p">,</span> <span class="n">retry_count</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s1">&#39;Inserting firewall rule </span><span class="si">%s</span><span class="s1"> on project </span><span class="si">%s</span><span class="s1">. Rule: </span><span class="si">%s</span><span class="s1">, &#39;</span>
            <span class="s1">&#39;Result: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">rule</span><span class="p">),</span> <span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="ComputeClient.update_firewall_rule"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.update_firewall_rule">[docs]</a>    <span class="k">def</span> <span class="nf">update_firewall_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">retry_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update a firewall rule.</span>

<span class="sd">        Args:</span>
<span class="sd">          project_id (str): The project id.</span>
<span class="sd">          rule (dict): The firewall rule dict to update.</span>
<span class="sd">          uuid (str): An optional UUID to identify this request. If the same</span>
<span class="sd">              request is resent to the API, it will ignore the additional</span>
<span class="sd">              requests. If uuid is not set, one will be generated for the</span>
<span class="sd">              request.</span>
<span class="sd">          blocking (bool): If true, don&#39;t return until the async operation</span>
<span class="sd">              completes on the backend or timeout seconds pass.</span>
<span class="sd">          retry_count (int): If greater than 0, retry on operation timeout.</span>
<span class="sd">          timeout (float): If greater than 0 and blocking is True, then raise an</span>
<span class="sd">              exception if timeout seconds pass before the operation completes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Global Operation status and info.</span>
<span class="sd">            https://cloud.google.com/compute/docs/reference/latest/globalOperations/get</span>

<span class="sd">        Raises:</span>
<span class="sd">            OperationTimeoutError: Raised if the operation times out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">firewalls</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">uuid</span><span class="p">:</span>
            <span class="n">uuid</span> <span class="o">=</span> <span class="n">uuid4</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                        <span class="n">data</span><span class="o">=</span><span class="n">rule</span><span class="p">,</span> <span class="n">requestId</span><span class="o">=</span><span class="n">uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">blocking</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Error updating firewall rule </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiNotEnabledError</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">OperationTimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s1">&#39;Timeout updating firewall rule </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">retry_count</span><span class="p">:</span>
                <span class="n">retry_count</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_firewall_rule</span><span class="p">(</span>
                    <span class="n">project_id</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">blocking</span><span class="p">,</span> <span class="n">retry_count</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s1">&#39;Updating firewall rule </span><span class="si">%s</span><span class="s1"> on project </span><span class="si">%s</span><span class="s1">. Rule: </span><span class="si">%s</span><span class="s1">, &#39;</span>
            <span class="s1">&#39;Result: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">rule</span><span class="p">),</span> <span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="ComputeClient.get_forwarding_rules"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_forwarding_rules">[docs]</a>    <span class="k">def</span> <span class="nf">get_forwarding_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the forwarding rules for a project.</span>

<span class="sd">        If no region name is specified, use aggregatedList() to query for</span>
<span class="sd">        forwarding rules in all regions.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            region (str): The region name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of forwarding rules for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">forwarding_rules</span>
        <span class="k">if</span> <span class="n">region</span><span class="p">:</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">_flatten_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">paged_results</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">aggregated_list</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">_flatten_aggregated_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                       <span class="n">paged_results</span><span class="p">,</span>
                                                       <span class="s1">&#39;forwardingRules&#39;</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the forwarding rules for a project, &#39;</span>
                     <span class="s1">&#39;project_id = </span><span class="si">%s</span><span class="s1">, region = </span><span class="si">%s</span><span class="s1">, results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="ComputeClient.get_global_operation"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_global_operation">[docs]</a>    <span class="k">def</span> <span class="nf">get_global_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">operation_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the Operations Status</span>
<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            operation_id (str): The operation id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Global Operation status and info.</span>
<span class="sd">            https://cloud.google.com/compute/docs/reference/latest/globalOperations/get</span>

<span class="sd">        Raises:</span>
<span class="sd">            ApiNotEnabledError: Returns if the api is not enabled.</span>
<span class="sd">            ApiExecutionError: Returns if the api is not executable.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">global_operations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">project_id</span><span class="p">,</span> <span class="n">operation_id</span><span class="p">)</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the operation status, project_id = </span><span class="si">%s</span><span class="s1">,&#39;</span>
                         <span class="s1">&#39; operation_id = </span><span class="si">%s</span><span class="s1">, results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                         <span class="n">project_id</span><span class="p">,</span> <span class="n">operation_id</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">results</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiNotEnabledError</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComputeClient.get_image"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_image">[docs]</a>    <span class="k">def</span> <span class="nf">get_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">image_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an image from a project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            image_name (str): The image name to get.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A Compute Image resource dict.</span>
<span class="sd">            https://cloud.google.com/compute/docs/reference/latest/images</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">image_name</span><span class="p">)</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting an image from a project, project_id = </span><span class="si">%s</span><span class="s1">, &#39;</span>
                         <span class="s1">&#39;image_name = </span><span class="si">%s</span><span class="s1">, results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                         <span class="n">project_id</span><span class="p">,</span> <span class="n">image_name</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">results</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiNotEnabledError</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComputeClient.get_images"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_images">[docs]</a>    <span class="k">def</span> <span class="nf">get_images</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all images created in a project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of images for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paged_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
        <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                  <span class="n">paged_results</span><span class="p">,</span>
                                                  <span class="s1">&#39;items&#39;</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting all images created in a project, &#39;</span>
                     <span class="s1">&#39;project_id = </span><span class="si">%s</span><span class="s1">, flattened_results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">flattened_results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flattened_results</span></div>

<div class="viewcode-block" id="ComputeClient.get_instance_group_instances"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_instance_group_instances">[docs]</a>    <span class="k">def</span> <span class="nf">get_instance_group_instances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">instance_group_name</span><span class="p">,</span>
                                     <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the instance groups for a project.</span>

<span class="sd">        One and only one of zone (for zonal instance groups) and region</span>
<span class="sd">        (for regional instance groups) must be specified.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            instance_group_name (str): The instance group&#39;s name.</span>
<span class="sd">            region (str): The regional instance group&#39;s region.</span>
<span class="sd">            zone (str): The zonal instance group&#39;s zone.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: instance URLs for this instance group.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: invalid combination of parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span> <span class="o">^</span> <span class="nb">bool</span><span class="p">(</span><span class="n">region</span><span class="p">):</span>
            <span class="n">err_message</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;One and only one of zone &#39;</span>
                           <span class="s1">&#39;and region must be specified.&#39;</span><span class="p">)</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_message</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_message</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zone</span><span class="p">:</span>
            <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">instance_groups</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">list_instances</span><span class="p">(</span>
                <span class="n">project_id</span><span class="p">,</span> <span class="n">instance_group_name</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span>
                <span class="n">fields</span><span class="o">=</span><span class="s1">&#39;items/instance,nextPageToken&#39;</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;instanceState&#39;</span><span class="p">:</span> <span class="s1">&#39;ALL&#39;</span><span class="p">})</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">region_instance_groups</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">list_instances</span><span class="p">(</span>
                <span class="n">project_id</span><span class="p">,</span> <span class="n">instance_group_name</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span>
                <span class="n">fields</span><span class="o">=</span><span class="s1">&#39;items/instance,nextPageToken&#39;</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;instanceState&#39;</span><span class="p">:</span> <span class="s1">&#39;ALL&#39;</span><span class="p">})</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">instance_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">instance_data</span> <span class="ow">in</span> <span class="n">_flatten_list_results</span><span class="p">(</span>
                <span class="n">project_id</span><span class="p">,</span> <span class="n">paged_results</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;instance&#39;</span> <span class="ow">in</span> <span class="n">instance_data</span>
        <span class="p">]</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the instance group for a project, project_id&#39;</span>
                     <span class="s1">&#39; = </span><span class="si">%s</span><span class="s1">, instance_group_name = </span><span class="si">%s</span><span class="s1">, region = </span><span class="si">%s</span><span class="s1">, &#39;</span>
                     <span class="s1">&#39;zone = </span><span class="si">%s</span><span class="s1">, flattened_results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">instance_group_name</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="ComputeClient.get_instance_group_managers"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_instance_group_managers">[docs]</a>    <span class="k">def</span> <span class="nf">get_instance_group_managers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the instance group managers for a project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of instance group managers for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paged_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">instance_group_managers</span><span class="o">.</span><span class="n">aggregated_list</span><span class="p">(</span>
            <span class="n">project_id</span><span class="p">)</span>
        <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_aggregated_list_results</span><span class="p">(</span>
            <span class="n">project_id</span><span class="p">,</span> <span class="n">paged_results</span><span class="p">,</span> <span class="s1">&#39;instanceGroupManagers&#39;</span><span class="p">)</span>

        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the instance group managers for a project, &#39;</span>
                     <span class="s1">&#39;project_id = </span><span class="si">%s</span><span class="s1">, flattened_results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">flattened_results</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">flattened_results</span></div>

<div class="viewcode-block" id="ComputeClient.get_instance_groups"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_instance_groups">[docs]</a>    <span class="k">def</span> <span class="nf">get_instance_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">include_instance_urls</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the instance groups for a project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            include_instance_urls (bool): If true, fetch instance urls for each</span>
<span class="sd">                instance group and include them in the resource dictionary.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of instance groups for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paged_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">instance_groups</span><span class="o">.</span><span class="n">aggregated_list</span><span class="p">(</span>
            <span class="n">project_id</span><span class="p">)</span>

        <span class="n">instance_groups</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="n">_flatten_aggregated_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">paged_results</span><span class="p">,</span>
                                             <span class="s1">&#39;instanceGroups&#39;</span><span class="p">),</span>
            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">include_instance_urls</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">instance_group</span> <span class="ow">in</span> <span class="n">instance_groups</span><span class="p">:</span>
                <span class="c1"># Turn zone and region URLs into a names</span>
                <span class="n">zone</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">instance_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                <span class="n">region</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">instance_group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                <span class="n">instance_group</span><span class="p">[</span><span class="s1">&#39;instance_urls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_instance_group_instances</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                      <span class="n">instance_group</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                                      <span class="n">zone</span><span class="o">=</span><span class="n">zone</span><span class="p">,</span>
                                                      <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">))</span>

        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the instance groups for a project, &#39;</span>
                     <span class="s1">&#39;project_id = </span><span class="si">%s</span><span class="s1">, instance_groups = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">instance_groups</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">instance_groups</span></div>

<div class="viewcode-block" id="ComputeClient.get_instance_templates"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_instance_templates">[docs]</a>    <span class="k">def</span> <span class="nf">get_instance_templates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the instance templates for a project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of instance templates for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paged_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">instance_templates</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
        <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                  <span class="n">paged_results</span><span class="p">,</span>
                                                  <span class="s1">&#39;items&#39;</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the instance templates for a project, &#39;</span>
                     <span class="s1">&#39;project_id = </span><span class="si">%s</span><span class="s1">, flattened_results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">flattened_results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flattened_results</span></div>

<div class="viewcode-block" id="ComputeClient.get_instances"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_instances">[docs]</a>    <span class="k">def</span> <span class="nf">get_instances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the instances for a project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            zone (str): The zone to list the instances in.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of instances for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">instances</span>
        <span class="k">if</span> <span class="n">zone</span><span class="p">:</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="p">)</span>
            <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                      <span class="n">paged_results</span><span class="p">,</span>
                                                      <span class="s1">&#39;items&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">aggregated_list</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
            <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_aggregated_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                                 <span class="n">paged_results</span><span class="p">,</span>
                                                                 <span class="s1">&#39;instances&#39;</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the instances for a project, project_id&#39;</span>
                     <span class="s1">&#39; = </span><span class="si">%s</span><span class="s1">, flattened_results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">flattened_results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flattened_results</span></div>

<div class="viewcode-block" id="ComputeClient.get_networks"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_networks">[docs]</a>    <span class="k">def</span> <span class="nf">get_networks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the networks list for a given project id.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of networks for this project id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paged_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
        <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                  <span class="n">paged_results</span><span class="p">,</span>
                                                  <span class="s1">&#39;items&#39;</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the network list for a given project,&#39;</span>
                     <span class="s1">&#39; project_id = </span><span class="si">%s</span><span class="s1">, flattened_results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">flattened_results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flattened_results</span></div>

<div class="viewcode-block" id="ComputeClient.get_project"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_project">[docs]</a>    <span class="k">def</span> <span class="nf">get_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the specified Project resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A Compute Project resource dict.</span>
<span class="sd">            https://cloud.google.com/compute/docs/reference/latest/projects/get</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">projects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the specified project resource, project_id&#39;</span>
                         <span class="s1">&#39; = </span><span class="si">%s</span><span class="s1">, results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">results</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiNotEnabledError</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComputeClient.get_quota"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_quota">[docs]</a>    <span class="k">def</span> <span class="nf">get_quota</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">metric</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the quota for any metric</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            metric (str): The metric name of the quota needed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The quota of a requested metric in a dict.</span>

<span class="sd">        An example return value:</span>

<span class="sd">            {</span>
<span class="sd">              &quot;metric&quot;: &quot;FIREWALLS&quot;,</span>
<span class="sd">              &quot;limit&quot;: 100.0,</span>
<span class="sd">              &quot;usage&quot;: 9.0</span>
<span class="sd">            }</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: Metric was not found in the project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_project</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
        <span class="n">quotas</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;quotas&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the quota for any metric, project_id = </span><span class="si">%s</span><span class="s1">,&#39;</span>
                     <span class="s1">&#39; metric = </span><span class="si">%s</span><span class="s1">, quotas = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">quotas</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">quota</span> <span class="ow">in</span> <span class="n">quotas</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">quota</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;metric&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">metric</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">quota</span>
        <span class="n">err</span> <span class="o">=</span> <span class="ne">KeyError</span><span class="p">(</span>
            <span class="s1">&#39;Passed in metric, </span><span class="si">%s</span><span class="s1">, was not found for project id, </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span>
            <span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">project_id</span><span class="p">))</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">err</span></div>

<div class="viewcode-block" id="ComputeClient.get_firewall_quota"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_firewall_quota">[docs]</a>    <span class="k">def</span> <span class="nf">get_firewall_quota</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calls get_quota to request the firewall quota</span>
<span class="sd">        Args:</span>
<span class="sd">          project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The quota of a requested metric in a dict.</span>

<span class="sd">        An example return value:</span>

<span class="sd">                {</span>
<span class="sd">                  &quot;metric&quot;: &quot;FIREWALLS&quot;,</span>
<span class="sd">                  &quot;limit&quot;: 100.0,</span>
<span class="sd">                  &quot;usage&quot;: 9.0</span>
<span class="sd">                }</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: Metric was not a firewall resource.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;FIREWALLS&#39;</span>
        <span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_quota</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting the firewall quota, project_id = </span><span class="si">%s</span><span class="s1">,&#39;</span>
                     <span class="s1">&#39; resource = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">resource</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resource</span></div>

<div class="viewcode-block" id="ComputeClient.get_subnetworks"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.get_subnetworks">[docs]</a>    <span class="k">def</span> <span class="nf">get_subnetworks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of all subnetworks in the project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            region (str): An optional region to query, if not provided then all</span>
<span class="sd">                subnetworks in all regions are returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of subnetwork resources for this project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">repository</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">subnetworks</span>
        <span class="k">if</span> <span class="n">region</span><span class="p">:</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
            <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                      <span class="n">paged_results</span><span class="p">,</span>
                                                      <span class="s1">&#39;items&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">paged_results</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">aggregated_list</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
            <span class="n">flattened_results</span> <span class="o">=</span> <span class="n">_flatten_aggregated_list_results</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                                 <span class="n">paged_results</span><span class="p">,</span>
                                                                 <span class="s1">&#39;subnetworks&#39;</span><span class="p">)</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Getting a list of all subnetworks in the project, &#39;</span>
                     <span class="s1">&#39;project_id = </span><span class="si">%s</span><span class="s1">, region = </span><span class="si">%s</span><span class="s1">, flattened_results = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">project_id</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">flattened_results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flattened_results</span></div>

<div class="viewcode-block" id="ComputeClient.is_api_enabled"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.is_api_enabled">[docs]</a>    <span class="k">def</span> <span class="nf">is_api_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if the Compute API is enabled for the specified project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the API is enabled, else False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">projects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Checking if Compute API is enabled, project_id = &#39;</span>
                         <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">, result = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>  <span class="c1"># True if name, otherwise False.</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">HttpError</span><span class="p">,</span> <span class="n">HttpLib2Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">api_not_enabled</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_api_not_enabled</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">api_not_enabled</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">ApiExecutionError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComputeClient.wait_for_completion"><a class="viewcode-back" href="../../../../../../google.cloud.forseti.common.gcp_api.compute.html#google.cloud.forseti.common.gcp_api.compute.ComputeClient.wait_for_completion">[docs]</a>    <span class="k">def</span> <span class="nf">wait_for_completion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                            <span class="n">initial_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait for the operation to complete.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): The project id.</span>
<span class="sd">            operation (dict): The global operation response from an API call.</span>
<span class="sd">            timeout (float): The maximum time to wait for the operation to</span>
<span class="sd">                complete.</span>
<span class="sd">            initial_delay (float): The time to wait before first checking if the</span>
<span class="sd">                API has completed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Global Operation status and info.</span>
<span class="sd">            https://cloud.google.com/compute/docs/reference/latest/globalOperations/get</span>

<span class="sd">        Raises:</span>
<span class="sd">            OperationTimeoutError: Raised if the operation times out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;DONE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">operation</span>

        <span class="k">if</span> <span class="n">initial_delay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">initial_delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ESTIMATED_API_COMPLETION_IN_SEC</span>

        <span class="n">started_timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">initial_delay</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">operation_name</span> <span class="o">=</span> <span class="n">operation</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="n">operation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_global_operation</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span>
                                                  <span class="n">operation_id</span><span class="o">=</span><span class="n">operation_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">operation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;DONE&#39;</span><span class="p">:</span>
                <span class="n">_debug_operation_response_time</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">operation</span>

            <span class="k">if</span> <span class="n">timeout</span> <span class="ow">and</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">started_timestamp</span> <span class="o">&gt;</span> <span class="n">timeout</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">api_errors</span><span class="o">.</span><span class="n">OperationTimeoutError</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></div></div>
</pre></div>
