---
layout: docs

title: "google.cloud.forseti.scanner.audit.base_rules_engine module"



hide:
  right_sidebar: true
---
<div class="section" id="module-google.cloud.forseti.scanner.audit.base_rules_engine">
<span id="google-cloud-forseti-scanner-audit-base-rules-engine-module"></span><h1>google.cloud.forseti.scanner.audit.base_rules_engine module<a class="headerlink" href="#module-google.cloud.forseti.scanner.audit.base_rules_engine" title="Permalink to this headline">¶</a></h1>
<p>Base class for policy scanner rules engines.</p>
<p>Loads YAML rules either from local file system or Cloud Storage bucket.</p>
<dl class="class">
<dt id="google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook">
<em class="property">class </em><code class="descname">BaseRuleBook</code><a class="reference internal" href="_modules/google/cloud/forseti/scanner/audit/base_rules_engine.html#BaseRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for RuleBooks.</p>
<p>The RuleBook class encapsulates the logic for how the RulesEngine will
lookup rules and find policy discrepancies. The actual structure of
the RuleBook depends on how rules should be applied. For example,
Organization resource rules would be applied in a hierarchical manner.</p>
<dl class="attribute">
<dt id="google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook._abc_cache">
<code class="descname">_abc_cache</code><em class="property"> = &lt;_weakrefset.WeakSet object&gt;</em><a class="headerlink" href="#google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook._abc_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook._abc_negative_cache">
<code class="descname">_abc_negative_cache</code><em class="property"> = &lt;_weakrefset.WeakSet object&gt;</em><a class="headerlink" href="#google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook._abc_negative_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook._abc_negative_cache_version">
<code class="descname">_abc_negative_cache_version</code><em class="property"> = 190</em><a class="headerlink" href="#google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook._abc_negative_cache_version" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook._abc_registry">
<code class="descname">_abc_registry</code><em class="property"> = &lt;_weakrefset.WeakSet object&gt;</em><a class="headerlink" href="#google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook._abc_registry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/google/cloud/forseti/scanner/audit/base_rules_engine.html#BaseRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.forseti.scanner.audit.base_rules_engine.BaseRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rule to rule book.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rule_def</strong> (<em>dict</em>) – Add a rule definition to the rule book.</li>
<li><strong>rule_index</strong> (<em>int</em>) – The index of the rule.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code> – The method should be defined in subclass.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.forseti.scanner.audit.base_rules_engine.BaseRulesEngine">
<em class="property">class </em><code class="descname">BaseRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path=None</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/google/cloud/forseti/scanner/audit/base_rules_engine.html#BaseRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.forseti.scanner.audit.base_rules_engine.BaseRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The base class for the rules engine.</p>
<dl class="method">
<dt id="google.cloud.forseti.scanner.audit.base_rules_engine.BaseRulesEngine._load_rule_definitions">
<code class="descname">_load_rule_definitions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/google/cloud/forseti/scanner/audit/base_rules_engine.html#BaseRulesEngine._load_rule_definitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.forseti.scanner.audit.base_rules_engine.BaseRulesEngine._load_rule_definitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the rule definitions file from GCS or local filesystem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The parsed dict from the rule definitions file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="google.cloud.forseti.scanner.audit.base_rules_engine.BaseRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/google/cloud/forseti/scanner/audit/base_rules_engine.html#BaseRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.forseti.scanner.audit.base_rules_engine.BaseRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build RuleBook from the rules definition file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>global_configs</strong> (<em>dict</em>) – The global Forseti configuration.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code> – The method should be defined in subclass.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>

